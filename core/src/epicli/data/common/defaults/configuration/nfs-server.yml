kind: configuration/nfs-server
title: NFS Server Config
name: default
specification:
  nfs_exports: # export definitions to be created in /etc/exports
    - directory: /nfs_share/public # export point, client mountable path
      default_options: [ro, sync, no_subtree_check]
      clients: # hosts or networks allowed to mount the export
        - hosts: "{{ groups.all }}"
          kind: ansible_inventory_hostname
      enabled: yes
    # TODO: temporary entries for testing different settings
    - directory: /nfs_share/private
      default_options: [rw, sync, no_subtree_check, 'sec=krb5p']
      clients:
        - hosts: "{{ groups.kubernetes_master }}"
          kind: ansible_inventory_hostname
        - hosts: "{{ groups.kubernetes_node }}"
      enabled: yes
    - directory: /nfs_share/public/subdir
      clients:
        - hosts: "{{ groups.kubernetes_master[0] }}"
          options: [rw, sync, no_subtree_check, 'sec=sys:krb5:krb5i:krb5p']
          kind: ansible_inventory_hostname
        - hosts: "{{ groups.kubernetes_node }}"
      enabled: yes
    - directory: /kerberos_share
      clients:
        - hosts: "{{ groups.all }}"
          options: [rw, sync, no_subtree_check, 'sec=krb5p']
          kind: ansible_inventory_hostname
      enabled: yes
